#!/usr/bin/env python3
"""
åŠ¨æ€æ€§èƒ½æŒ‡æ ‡å®šä¹‰å’Œè®¡ç®—æ–¹å¼è¯¦è§£
20ä¸ªå…³é”®æ€§èƒ½æŒ‡æ ‡çš„å®Œæ•´è¯´æ˜æ–‡æ¡£
"""

import pandas as pd
import os

def create_metrics_definition_guide():
    """åˆ›å»ºè¯¦ç»†çš„æŒ‡æ ‡å®šä¹‰æŒ‡å—"""
    
    # å®šä¹‰æ‰€æœ‰20ä¸ªæŒ‡æ ‡
    metrics_definitions = [
        {
            "æŒ‡æ ‡åç§°": "duration_mean",
            "ä¸­æ–‡åç§°": "å¹³å‡è¡Œé©¶æ—¶é—´",
            "åˆ†ç±»": "è½¦è¾†è¡Œç¨‹æ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "æ‰€æœ‰è½¦è¾†ä»å‡ºå‘åˆ°åˆ°è¾¾ç›®çš„åœ°çš„å¹³å‡è¡Œé©¶æ—¶é—´",
            "è®¡ç®—å…¬å¼": "mean(è½¦è¾†içš„duration) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„durationå±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "åæ˜ æ•´ä½“äº¤é€šæµæ•ˆç‡ï¼Œå€¼è¶Šå°è¡¨ç¤ºäº¤é€šè¶Šé¡ºç•…",
            "å½±å“å› ç´ ": "å……ç”µç«™å¸ƒå±€ã€äº¤é€šæ‹¥å µã€è·¯ç½‘ç»“æ„"
        },
        {
            "æŒ‡æ ‡åç§°": "duration_median",
            "ä¸­æ–‡åç§°": "è¡Œé©¶æ—¶é—´ä¸­ä½æ•°",
            "åˆ†ç±»": "è½¦è¾†è¡Œç¨‹æ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "æ‰€æœ‰è½¦è¾†è¡Œé©¶æ—¶é—´çš„ä¸­ä½æ•°ï¼ˆ50%åˆ†ä½æ•°ï¼‰",
            "è®¡ç®—å…¬å¼": "median(è½¦è¾†içš„duration) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„durationå±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "æ›´ç¨³å¥çš„ä¸­å¿ƒè¶‹åŠ¿æŒ‡æ ‡ï¼Œä¸å—æå€¼å½±å“",
            "å½±å“å› ç´ ": "ç½‘ç»œæ‹¥å µåˆ†å¸ƒã€å……ç”µç«™å¯è¾¾æ€§"
        },
        {
            "æŒ‡æ ‡åç§°": "duration_p90",
            "ä¸­æ–‡åç§°": "è¡Œé©¶æ—¶é—´90åˆ†ä½æ•°",
            "åˆ†ç±»": "è½¦è¾†è¡Œç¨‹æ—¶é—´æŒ‡æ ‡", 
            "å®šä¹‰": "90%çš„è½¦è¾†è¡Œé©¶æ—¶é—´ä½äºæ­¤å€¼",
            "è®¡ç®—å…¬å¼": "percentile(è½¦è¾†içš„duration, 90) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„durationå±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "åæ˜ æœ€ä¸åˆ©æƒ…å†µä¸‹çš„è¡Œç¨‹æ—¶é—´ï¼Œè¡¡é‡ç³»ç»Ÿå¯é æ€§",
            "å½±å“å› ç´ ": "æç«¯æ‹¥å µã€å……ç”µç­‰å¾…ã€è·¯ç½‘ç“¶é¢ˆ"
        },
        {
            "æŒ‡æ ‡åç§°": "charging_time_mean",
            "ä¸­æ–‡åç§°": "å¹³å‡å……ç”µæ—¶é—´",
            "åˆ†ç±»": "å……ç”µæ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "æ‰€æœ‰å……ç”µäº‹ä»¶çš„å¹³å‡æŒç»­æ—¶é—´",
            "è®¡ç®—å…¬å¼": "mean(å……ç”µæ¡©jçš„chargingSteps) for j in æ‰€æœ‰æœ‰å……ç”µæ´»åŠ¨çš„å……ç”µæ¡©",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„chargingStepså±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "åæ˜ å¹³å‡å……ç”µæœåŠ¡æ—¶é—´ï¼Œå€¼è¶Šå°è¡¨ç¤ºå……ç”µæ•ˆç‡è¶Šé«˜",
            "å½±å“å› ç´ ": "å……ç”µæ¡©åŠŸç‡ã€ç”µæ± å®¹é‡ã€å……ç”µç­–ç•¥"
        },
        {
            "æŒ‡æ ‡åç§°": "charging_time_median", 
            "ä¸­æ–‡åç§°": "å……ç”µæ—¶é—´ä¸­ä½æ•°",
            "åˆ†ç±»": "å……ç”µæ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "æ‰€æœ‰å……ç”µäº‹ä»¶æ—¶é—´çš„ä¸­ä½æ•°",
            "è®¡ç®—å…¬å¼": "median(å……ç”µæ¡©jçš„chargingSteps) for j in æ‰€æœ‰æœ‰å……ç”µæ´»åŠ¨çš„å……ç”µæ¡©",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„chargingStepså±æ€§", 
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "æ›´ç¨³å¥çš„å……ç”µæ—¶é—´ä¸­å¿ƒè¶‹åŠ¿",
            "å½±å“å› ç´ ": "å……ç”µéœ€æ±‚åˆ†å¸ƒã€å……ç”µæ¡©é…ç½®"
        },
        {
            "æŒ‡æ ‡åç§°": "charging_time_p90",
            "ä¸­æ–‡åç§°": "å……ç”µæ—¶é—´90åˆ†ä½æ•°", 
            "åˆ†ç±»": "å……ç”µæ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "90%çš„å……ç”µäº‹ä»¶æ—¶é—´ä½äºæ­¤å€¼",
            "è®¡ç®—å…¬å¼": "percentile(å……ç”µæ¡©jçš„chargingSteps, 90) for j in æ‰€æœ‰æœ‰å……ç”µæ´»åŠ¨çš„å……ç”µæ¡©",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„chargingStepså±æ€§",
            "å•ä½": "ç§’(s)", 
            "è§£é‡Š": "åæ˜ æç«¯æƒ…å†µä¸‹çš„å……ç”µæ—¶é—´ï¼Œè¡¡é‡å……ç”µç³»ç»Ÿå‹åŠ›",
            "å½±å“å› ç´ ": "é«˜å³°æœŸæ’é˜Ÿã€å……ç”µæ¡©æ•…éšœã€ç‰¹æ®Šå……ç”µéœ€æ±‚"
        },
        {
            "æŒ‡æ ‡åç§°": "waiting_time_mean",
            "ä¸­æ–‡åç§°": "å¹³å‡ç­‰å¾…æ—¶é—´",
            "åˆ†ç±»": "è½¦è¾†ç­‰å¾…æ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "æ‰€æœ‰è½¦è¾†çš„å¹³å‡ç­‰å¾…æ—¶é—´ï¼ˆåŒ…æ‹¬äº¤é€šä¿¡å·ã€æ‹¥å µç­‰å¾…ï¼‰",
            "è®¡ç®—å…¬å¼": "mean(è½¦è¾†içš„waitingTime) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„waitingTimeå±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "åæ˜ äº¤é€šæ‹¥å µç¨‹åº¦ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºæ‹¥å µè¶Šä¸¥é‡",
            "å½±å“å› ç´ ": "äº¤é€šæµé‡ã€ä¿¡å·æ§åˆ¶ã€è·¯ç½‘å®¹é‡ã€å……ç”µç«™æ’é˜Ÿ"
        },
        {
            "æŒ‡æ ‡åç§°": "waiting_time_median",
            "ä¸­æ–‡åç§°": "ç­‰å¾…æ—¶é—´ä¸­ä½æ•°",
            "åˆ†ç±»": "è½¦è¾†ç­‰å¾…æ—¶é—´æŒ‡æ ‡", 
            "å®šä¹‰": "æ‰€æœ‰è½¦è¾†ç­‰å¾…æ—¶é—´çš„ä¸­ä½æ•°",
            "è®¡ç®—å…¬å¼": "median(è½¦è¾†içš„waitingTime) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„waitingTimeå±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "æ›´ç¨³å¥çš„ç­‰å¾…æ—¶é—´æŒ‡æ ‡ï¼Œå‡å°‘æå€¼å½±å“",
            "å½±å“å› ç´ ": "å¸¸è§„æ‹¥å µæ°´å¹³ã€äº¤é€šç»„ç»‡"
        },
        {
            "æŒ‡æ ‡åç§°": "waiting_time_p90",
            "ä¸­æ–‡åç§°": "ç­‰å¾…æ—¶é—´90åˆ†ä½æ•°",
            "åˆ†ç±»": "è½¦è¾†ç­‰å¾…æ—¶é—´æŒ‡æ ‡",
            "å®šä¹‰": "90%çš„è½¦è¾†ç­‰å¾…æ—¶é—´ä½äºæ­¤å€¼", 
            "è®¡ç®—å…¬å¼": "percentile(è½¦è¾†içš„waitingTime, 90) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„waitingTimeå±æ€§",
            "å•ä½": "ç§’(s)",
            "è§£é‡Š": "åæ˜ æœ€åæƒ…å†µä¸‹çš„ç­‰å¾…æ—¶é—´ï¼Œè¡¡é‡ç³»ç»Ÿé²æ£’æ€§",
            "å½±å“å› ç´ ": "ä¸¥é‡æ‹¥å µã€äº¤é€šäº‹æ•…ã€å……ç”µç«™æ’é˜Ÿ"
        },
        {
            "æŒ‡æ ‡åç§°": "energy_gini",
            "ä¸­æ–‡åç§°": "å……ç”µé‡åŸºå°¼ç³»æ•°",
            "åˆ†ç±»": "èƒ½æºåˆ†é…å…¬å¹³æ€§æŒ‡æ ‡",
            "å®šä¹‰": "è¡¡é‡å……ç”µæ¡©é—´å……ç”µé‡åˆ†å¸ƒçš„ä¸å‡åŒ€ç¨‹åº¦",
            "è®¡ç®—å…¬å¼": "Gini(å……ç”µæ¡©jçš„totalEnergyCharged) = (2Î£(iÃ—x_i))/(nÃ—Î£x_i) - (n+1)/n",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„totalEnergyChargedå±æ€§",
            "å•ä½": "æ— é‡çº² [0,1]",
            "è§£é‡Š": "0è¡¨ç¤ºå®Œå…¨å‡åŒ€ï¼Œ1è¡¨ç¤ºå®Œå…¨ä¸å‡åŒ€ã€‚å€¼è¶Šå¤§è¡¨ç¤ºå……ç”µé‡åˆ†å¸ƒè¶Šä¸å¹³è¡¡",
            "å½±å“å› ç´ ": "å……ç”µç«™å¸ƒå±€ã€EVå‡ºè¡Œæ¨¡å¼ã€å……ç”µç«™å®¹é‡"
        },
        {
            "æŒ‡æ ‡åç§°": "energy_cv",
            "ä¸­æ–‡åç§°": "å……ç”µé‡å˜å¼‚ç³»æ•°",
            "åˆ†ç±»": "èƒ½æºåˆ†é…å…¬å¹³æ€§æŒ‡æ ‡", 
            "å®šä¹‰": "å……ç”µæ¡©å……ç”µé‡çš„æ ‡å‡†å·®ä¸å‡å€¼çš„æ¯”å€¼",
            "è®¡ç®—å…¬å¼": "CV = std(totalEnergyCharged) / mean(totalEnergyCharged)",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„totalEnergyChargedå±æ€§",
            "å•ä½": "æ— é‡çº²",
            "è§£é‡Š": "è¡¡é‡å……ç”µé‡çš„ç›¸å¯¹å˜å¼‚ç¨‹åº¦ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºåˆ†å¸ƒè¶Šåˆ†æ•£",
            "å½±å“å› ç´ ": "å……ç”µéœ€æ±‚åˆ†å¸ƒã€å……ç”µç«™è®¾è®¡ã€ç©ºé—´å¯è¾¾æ€§"
        },
        {
            "æŒ‡æ ‡åç§°": "energy_hhi", 
            "ä¸­æ–‡åç§°": "å……ç”µé‡HHIæŒ‡æ•°",
            "åˆ†ç±»": "èƒ½æºåˆ†é…å…¬å¹³æ€§æŒ‡æ ‡",
            "å®šä¹‰": "èµ«èŠ¬è¾¾å°”-èµ«å¸Œæ›¼æŒ‡æ•°ï¼Œè¡¡é‡å……ç”µé‡é›†ä¸­ç¨‹åº¦",
            "è®¡ç®—å…¬å¼": "HHI = Î£(s_i^2), å…¶ä¸­s_iæ˜¯å……ç”µæ¡©içš„å……ç”µé‡ä»½é¢",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„totalEnergyChargedå±æ€§",
            "å•ä½": "æ— é‡çº² [0,1]",
            "è§£é‡Š": "å€¼è¶Šå¤§è¡¨ç¤ºå……ç”µé‡è¶Šé›†ä¸­åœ¨å°‘æ•°å……ç”µæ¡©ä¸Šï¼Œåæ˜ å¸‚åœºé›†ä¸­åº¦",
            "å½±å“å› ç´ ": "å……ç”µç«™å¸ƒå±€ä¼˜åŒ–ç¨‹åº¦ã€EVè·¯å¾„é€‰æ‹©"
        },
        {
            "æŒ‡æ ‡åç§°": "energy_p90_p50_ratio",
            "ä¸­æ–‡åç§°": "å……ç”µé‡90/50åˆ†ä½æ•°æ¯”å€¼",
            "åˆ†ç±»": "èƒ½æºåˆ†é…å…¬å¹³æ€§æŒ‡æ ‡",
            "å®šä¹‰": "90åˆ†ä½æ•°å……ç”µé‡ä¸50åˆ†ä½æ•°å……ç”µé‡çš„æ¯”å€¼",
            "è®¡ç®—å…¬å¼": "P90(totalEnergyCharged) / P50(totalEnergyCharged)",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­çš„totalEnergyChargedå±æ€§", 
            "å•ä½": "æ— é‡çº²",
            "è§£é‡Š": "è¡¡é‡é«˜è´Ÿè·å……ç”µæ¡©ä¸ä¸­ç­‰è´Ÿè·å……ç”µæ¡©çš„å·®å¼‚å€æ•°",
            "å½±å“å› ç´ ": "å……ç”µç«™åˆ©ç”¨ç‡åˆ†åŒ–ã€ä½ç½®ä¼˜åŠ¿å·®å¼‚"
        },
        {
            "æŒ‡æ ‡åç§°": "vehicle_gini",
            "ä¸­æ–‡åç§°": "å……ç”µè½¦è¾†æ•°åŸºå°¼ç³»æ•°", 
            "åˆ†ç±»": "è½¦è¾†åˆ†é…å…¬å¹³æ€§æŒ‡æ ‡",
            "å®šä¹‰": "è¡¡é‡å……ç”µæ¡©é—´æœåŠ¡è½¦è¾†æ•°åˆ†å¸ƒçš„ä¸å‡åŒ€ç¨‹åº¦",
            "è®¡ç®—å…¬å¼": "Gini(å……ç”µæ¡©jæœåŠ¡çš„è½¦è¾†æ•°)",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­æ¯ä¸ªå……ç”µæ¡©çš„vehicleå…ƒç´ æ•°é‡",
            "å•ä½": "æ— é‡çº² [0,1]",
            "è§£é‡Š": "åæ˜ å……ç”µæ¡©æœåŠ¡è´Ÿè·çš„å…¬å¹³æ€§ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºè´Ÿè·åˆ†å¸ƒè¶Šä¸å‡",
            "å½±å“å› ç´ ": "å……ç”µç«™å®¹é‡é…ç½®ã€åœ°ç†åˆ†å¸ƒã€äº¤é€šæµåˆ†å¸ƒ"
        },
        {
            "æŒ‡æ ‡åç§°": "vehicle_cv",
            "ä¸­æ–‡åç§°": "å……ç”µè½¦è¾†æ•°å˜å¼‚ç³»æ•°",
            "åˆ†ç±»": "è½¦è¾†åˆ†é…å…¬å¹³æ€§æŒ‡æ ‡",
            "å®šä¹‰": "å……ç”µæ¡©æœåŠ¡è½¦è¾†æ•°çš„æ ‡å‡†å·®ä¸å‡å€¼æ¯”å€¼",
            "è®¡ç®—å…¬å¼": "CV = std(è½¦è¾†æ•°) / mean(è½¦è¾†æ•°)",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­æ¯ä¸ªå……ç”µæ¡©çš„vehicleå…ƒç´ æ•°é‡",
            "å•ä½": "æ— é‡çº²", 
            "è§£é‡Š": "è¡¡é‡å……ç”µæ¡©æœåŠ¡é‡çš„ç›¸å¯¹ç¦»æ•£ç¨‹åº¦",
            "å½±å“å› ç´ ": "å……ç”µç«™è§„æ¨¡å·®å¼‚ã€ä½ç½®å¸å¼•åŠ›"
        },
        {
            "æŒ‡æ ‡åç§°": "vehicle_hhi",
            "ä¸­æ–‡åç§°": "å……ç”µè½¦è¾†æ•°HHIæŒ‡æ•°",
            "åˆ†ç±»": "è½¦è¾†åˆ†é…å…¬å¹³æ€§æŒ‡æ ‡",
            "å®šä¹‰": "å……ç”µæ¡©æœåŠ¡è½¦è¾†æ•°çš„é›†ä¸­åº¦æŒ‡æ•°",
            "è®¡ç®—å…¬å¼": "HHI = Î£(s_i^2), å…¶ä¸­s_iæ˜¯å……ç”µæ¡©içš„æœåŠ¡è½¦è¾†ä»½é¢",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­æ¯ä¸ªå……ç”µæ¡©çš„vehicleå…ƒç´ æ•°é‡",
            "å•ä½": "æ— é‡çº² [0,1]",
            "è§£é‡Š": "å€¼è¶Šå¤§è¡¨ç¤ºæœåŠ¡è¶Šé›†ä¸­åœ¨å°‘æ•°å……ç”µæ¡©ï¼Œåæ˜ è´Ÿè·é›†ä¸­ç¨‹åº¦",
            "å½±å“å› ç´ ": "å……ç”µç«™å¸ƒå±€åˆç†æ€§ã€ç½‘ç»œæ•ˆåº”"
        },
        {
            "æŒ‡æ ‡åç§°": "charging_station_coverage",
            "ä¸­æ–‡åç§°": "å……ç”µæ¡©ä½¿ç”¨è¦†ç›–ç‡",
            "åˆ†ç±»": "åŸºç¡€è®¾æ–½åˆ©ç”¨ç‡æŒ‡æ ‡", 
            "å®šä¹‰": "æœ‰å®é™…å……ç”µæ´»åŠ¨çš„å……ç”µæ¡©å æ€»å……ç”µæ¡©æ•°é‡çš„æ¯”ä¾‹",
            "è®¡ç®—å…¬å¼": "ä½¿ç”¨è¿‡çš„å……ç”µæ¡©æ•°é‡ / æ€»å……ç”µæ¡©æ•°é‡",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­totalEnergyCharged > 0çš„å……ç”µæ¡©",
            "å•ä½": "æ— é‡çº² [0,1]",
            "è§£é‡Š": "åæ˜ å……ç”µåŸºç¡€è®¾æ–½çš„åˆ©ç”¨ç¨‹åº¦ï¼Œå€¼è¶Šé«˜è¡¨ç¤ºåˆ©ç”¨ç‡è¶Šå¥½",
            "å½±å“å› ç´ ": "å……ç”µç«™å¸ƒå±€åˆç†æ€§ã€å……ç”µéœ€æ±‚åˆ†å¸ƒã€å¯è¾¾æ€§"
        },
        {
            "æŒ‡æ ‡åç§°": "reroute_count",
            "ä¸­æ–‡åç§°": "é‡æ–°è·¯ç”±è½¦è¾†æ•°",
            "åˆ†ç±»": "äº¤é€šç³»ç»Ÿç¨³å®šæ€§æŒ‡æ ‡",
            "å®šä¹‰": "åœ¨è¡Œç¨‹ä¸­å‘ç”Ÿé‡æ–°è·¯ç”±çš„è½¦è¾†æ€»æ•°",
            "è®¡ç®—å…¬å¼": "count(è½¦è¾†içš„rerouteNo > 0) for i in æ‰€æœ‰è½¦è¾†",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„rerouteNoå±æ€§",
            "å•ä½": "è½¦è¾†æ•°",
            "è§£é‡Š": "åæ˜ äº¤é€šç³»ç»Ÿçš„ä¸ç¨³å®šæ€§ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºäº¤é€šæ‰°åŠ¨è¶Šå¤š",
            "å½±å“å› ç´ ": "äº¤é€šæ‹¥å µã€å……ç”µç«™æ’é˜Ÿã€è·¯ç½‘ç“¶é¢ˆã€åŠ¨æ€äº¤é€šç®¡ç†"
        },
        {
            "æŒ‡æ ‡åç§°": "ev_charging_participation_rate", 
            "ä¸­æ–‡åç§°": "EVå……ç”µå‚ä¸ç‡",
            "åˆ†ç±»": "å……ç”µæœåŠ¡è¦†ç›–æŒ‡æ ‡",
            "å®šä¹‰": "å®é™…å‚ä¸å……ç”µçš„EVæ•°é‡å æ€»EVæ•°é‡çš„æ¯”ä¾‹",
            "è®¡ç®—å…¬å¼": "å®é™…å……ç”µçš„EVæ•°é‡ / æ€»EVæ•°é‡(1800)",
            "æ•°æ®æ¥æº": "chargingevents.xmlä¸­IDä»¥'EV_'å¼€å¤´çš„vehicleå…ƒç´ ",
            "å•ä½": "æ— é‡çº² [0,1]",
            "è§£é‡Š": "åæ˜ å……ç”µæœåŠ¡çš„è¦†ç›–ç¨‹åº¦ï¼Œå€¼è¶Šé«˜è¡¨ç¤ºæ›´å¤šEVèƒ½è·å¾—å……ç”µæœåŠ¡",
            "å½±å“å› ç´ ": "å……ç”µç«™å¯†åº¦ã€å……ç”µæ¡©å®¹é‡ã€EVè¡Œç¨‹ç‰¹å¾ã€å……ç”µç­–ç•¥"
        },
        {
            "æŒ‡æ ‡åç§°": "ev_charging_failures",
            "ä¸­æ–‡åç§°": "EVå……ç”µå¤±è´¥æ•°",
            "åˆ†ç±»": "å……ç”µæœåŠ¡è´¨é‡æŒ‡æ ‡",
            "å®šä¹‰": "æœªèƒ½æˆåŠŸå®Œæˆå……ç”µçš„EVæ•°é‡",
            "è®¡ç®—å…¬å¼": "count(stationfinderå…ƒç´ ) in tripinfo_output.xml",
            "æ•°æ®æ¥æº": "tripinfo_output.xmlä¸­çš„stationfinderå­å…ƒç´ ",
            "å•ä½": "è½¦è¾†æ•°", 
            "è§£é‡Š": "åæ˜ å……ç”µç³»ç»Ÿçš„æœåŠ¡å¤±è´¥æƒ…å†µï¼Œå€¼è¶Šå¤§è¡¨ç¤ºå……ç”µæœåŠ¡è´¨é‡è¶Šå·®",
            "å½±å“å› ç´ ": "å……ç”µç«™å®¹é‡ä¸è¶³ã€ä½ç½®ä¸åˆç†ã€å……ç”µæ¡©æ•…éšœã€æ’é˜Ÿç­‰å¾…è¶…æ—¶"
        }
    ]
    
    # åˆ›å»ºDataFrame
    df = pd.DataFrame(metrics_definitions)
    
    # ä¿å­˜ä¸ºCSVæ–‡ä»¶
    output_file = "analysis/charts/correlation/metrics_definition_guide.csv"
    df.to_csv(output_file, index=False, encoding='utf-8-sig')
    print(f"âœ… æŒ‡æ ‡å®šä¹‰æŒ‡å—å·²ä¿å­˜åˆ°: {output_file}")
    
    # åˆ›å»ºç®€åŒ–çš„è‹±æ–‡ç‰ˆæœ¬
    english_definitions = []
    for metric in metrics_definitions:
        english_definitions.append({
            "Metric": metric["æŒ‡æ ‡åç§°"],
            "Category": metric["åˆ†ç±»"],
            "Definition": metric["å®šä¹‰"],
            "Unit": metric["å•ä½"],
            "Data_Source": metric["æ•°æ®æ¥æº"]
        })
    
    df_english = pd.DataFrame(english_definitions)
    english_output_file = "analysis/charts/correlation/metrics_definition_english.csv"
    df_english.to_csv(english_output_file, index=False)
    print(f"âœ… è‹±æ–‡ç‰ˆæŒ‡æ ‡å®šä¹‰å·²ä¿å­˜åˆ°: {english_output_file}")
    
    return df, df_english

def create_metrics_summary_report():
    """åˆ›å»ºæŒ‡æ ‡æ‘˜è¦æŠ¥å‘Š"""
    
    report_content = """
# åŠ¨æ€æ€§èƒ½æŒ‡æ ‡å®šä¹‰å’Œè®¡ç®—æ–¹å¼è¯¦è§£

## æ¦‚è¿°
æœ¬ç ”ç©¶é‡‡ç”¨20ä¸ªåŠ¨æ€æ€§èƒ½æŒ‡æ ‡æ¥å…¨é¢è¯„ä¼°å……ç”µç«™å¸ƒå±€å¯¹ç”µåŠ¨è½¦äº¤é€šç³»ç»Ÿçš„å½±å“ã€‚è¿™äº›æŒ‡æ ‡åˆ†ä¸º6å¤§ç±»ï¼š

## æŒ‡æ ‡åˆ†ç±»ä½“ç³»

### 1. è½¦è¾†è¡Œç¨‹æ—¶é—´æŒ‡æ ‡ (Vehicle Trip Time Metrics)
- **duration_mean**: å¹³å‡è¡Œé©¶æ—¶é—´ - åæ˜ æ•´ä½“äº¤é€šæ•ˆç‡
- **duration_median**: è¡Œé©¶æ—¶é—´ä¸­ä½æ•° - ç¨³å¥çš„ä¸­å¿ƒè¶‹åŠ¿æŒ‡æ ‡  
- **duration_p90**: è¡Œé©¶æ—¶é—´90åˆ†ä½æ•° - æç«¯æƒ…å†µä¸‹çš„ç³»ç»Ÿå¯é æ€§

### 2. å……ç”µæ—¶é—´æŒ‡æ ‡ (Charging Time Metrics)  
- **charging_time_mean**: å¹³å‡å……ç”µæ—¶é—´ - å……ç”µæ•ˆç‡æŒ‡æ ‡
- **charging_time_median**: å……ç”µæ—¶é—´ä¸­ä½æ•° - å…¸å‹å……ç”µæœåŠ¡æ—¶é—´
- **charging_time_p90**: å……ç”µæ—¶é—´90åˆ†ä½æ•° - å……ç”µç³»ç»Ÿå‹åŠ›æŒ‡æ ‡

### 3. è½¦è¾†ç­‰å¾…æ—¶é—´æŒ‡æ ‡ (Vehicle Waiting Time Metrics)
- **waiting_time_mean**: å¹³å‡ç­‰å¾…æ—¶é—´ - äº¤é€šæ‹¥å µç¨‹åº¦
- **waiting_time_median**: ç­‰å¾…æ—¶é—´ä¸­ä½æ•° - å¸¸è§„æ‹¥å µæ°´å¹³  
- **waiting_time_p90**: ç­‰å¾…æ—¶é—´90åˆ†ä½æ•° - æç«¯æ‹¥å µæƒ…å†µ

### 4. èƒ½æºåˆ†é…å…¬å¹³æ€§æŒ‡æ ‡ (Energy Distribution Equity Metrics)
- **energy_gini**: å……ç”µé‡åŸºå°¼ç³»æ•° - å……ç”µæ¡©é—´è´Ÿè·åˆ†å¸ƒå‡åŒ€ç¨‹åº¦
- **energy_cv**: å……ç”µé‡å˜å¼‚ç³»æ•° - å……ç”µé‡ç›¸å¯¹å˜å¼‚ç¨‹åº¦
- **energy_hhi**: å……ç”µé‡HHIæŒ‡æ•° - å……ç”µé‡é›†ä¸­åº¦
- **energy_p90_p50_ratio**: å……ç”µé‡90/50åˆ†ä½æ•°æ¯”å€¼ - é«˜ä½è´Ÿè·å·®å¼‚

### 5. è½¦è¾†åˆ†é…å…¬å¹³æ€§æŒ‡æ ‡ (Vehicle Distribution Equity Metrics)  
- **vehicle_gini**: å……ç”µè½¦è¾†æ•°åŸºå°¼ç³»æ•° - æœåŠ¡è´Ÿè·åˆ†å¸ƒå…¬å¹³æ€§
- **vehicle_cv**: å……ç”µè½¦è¾†æ•°å˜å¼‚ç³»æ•° - æœåŠ¡é‡ç¦»æ•£ç¨‹åº¦
- **vehicle_hhi**: å……ç”µè½¦è¾†æ•°HHIæŒ‡æ•° - æœåŠ¡é›†ä¸­åº¦

### 6. ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡ (System Performance Metrics)
- **charging_station_coverage**: å……ç”µæ¡©ä½¿ç”¨è¦†ç›–ç‡ - åŸºç¡€è®¾æ–½åˆ©ç”¨ç‡
- **reroute_count**: é‡æ–°è·¯ç”±è½¦è¾†æ•° - äº¤é€šç³»ç»Ÿç¨³å®šæ€§
- **ev_charging_participation_rate**: EVå……ç”µå‚ä¸ç‡ - å……ç”µæœåŠ¡è¦†ç›–åº¦
- **ev_charging_failures**: EVå……ç”µå¤±è´¥æ•° - å……ç”µæœåŠ¡è´¨é‡

## æ•°æ®æ¥æºè¯´æ˜

### SUMOä»¿çœŸè¾“å‡ºæ–‡ä»¶:
1. **tripinfo_output.xml**: åŒ…å«æ¯è¾†è½¦çš„è¡Œç¨‹ä¿¡æ¯
   - duration: è½¦è¾†æ€»è¡Œç¨‹æ—¶é—´
   - waitingTime: è½¦è¾†æ€»ç­‰å¾…æ—¶é—´
   - rerouteNo: é‡æ–°è·¯ç”±æ¬¡æ•°
   - stationfinder: å……ç”µå¤±è´¥æ ‡è®°

2. **chargingevents.xml**: åŒ…å«å……ç”µç«™ä½¿ç”¨ä¿¡æ¯  
   - chargingSteps: å……ç”µæŒç»­æ—¶é—´
   - totalEnergyCharged: æ€»å……ç”µé‡
   - vehicle: å……ç”µè½¦è¾†åˆ—è¡¨

## è®¡ç®—æ–¹æ³•ç‰¹ç‚¹

### ç»Ÿè®¡æŒ‡æ ‡é€‰æ‹©åŸåˆ™:
- **Mean (å‡å€¼)**: åæ˜ æ€»ä½“å¹³å‡æ°´å¹³
- **Median (ä¸­ä½æ•°)**: å‡å°‘æå€¼å½±å“ï¼Œæ›´ç¨³å¥
- **P90 (90åˆ†ä½æ•°)**: æ•æ‰æç«¯æƒ…å†µï¼Œè¯„ä¼°ç³»ç»Ÿé²æ£’æ€§

### å…¬å¹³æ€§æŒ‡æ ‡å«ä¹‰:
- **Giniç³»æ•°**: [0,1]ï¼Œ0=å®Œå…¨å‡åŒ€ï¼Œ1=å®Œå…¨ä¸å‡åŒ€
- **å˜å¼‚ç³»æ•°CV**: æ ‡å‡†å·®/å‡å€¼ï¼Œè¡¡é‡ç›¸å¯¹ç¦»æ•£ç¨‹åº¦  
- **HHIæŒ‡æ•°**: [0,1]ï¼Œè¡¡é‡é›†ä¸­åº¦ï¼Œå€¼è¶Šå¤§è¶Šé›†ä¸­
- **P90/P50æ¯”å€¼**: é«˜è´Ÿè·ä¸ä¸­ç­‰è´Ÿè·çš„å€æ•°å…³ç³»

## æŒ‡æ ‡é—´ç›¸å…³æ€§ç‰¹å¾

æ ¹æ®ç›¸å…³æ€§åˆ†æç»“æœï¼Œä¸»è¦å‘ç°:

1. **infrastructure-performance nexus**: å……ç”µç«™è¦†ç›–ç‡ä¸å¤šä¸ªæ€§èƒ½æŒ‡æ ‡å¼ºç›¸å…³
2. **Concentration effects**: HHIæŒ‡æ•°ç±»æŒ‡æ ‡é«˜åº¦ç›¸å…³ï¼Œåæ˜ èµ„æºåˆ†é…æ¨¡å¼
3. **Time performance clustering**: å„ç±»æ—¶é—´æŒ‡æ ‡å†…éƒ¨é«˜åº¦ç›¸å…³
4. **Equity-efficiency trade-off**: å…¬å¹³æ€§ä¸æ•ˆç‡æŒ‡æ ‡å­˜åœ¨æƒè¡¡å…³ç³»

## åº”ç”¨ä»·å€¼

è¿™20ä¸ªæŒ‡æ ‡å½¢æˆäº†ä¸€ä¸ªå…¨é¢çš„è¯„ä¼°æ¡†æ¶ï¼Œèƒ½å¤Ÿ:
- é‡åŒ–å……ç”µç«™å¸ƒå±€å¯¹äº¤é€šç³»ç»Ÿçš„å¤šç»´å½±å“
- è¯†åˆ«ä¸åŒå¸ƒå±€ç­–ç•¥çš„æ€§èƒ½æƒè¡¡  
- ä¸ºå……ç”µåŸºç¡€è®¾æ–½è§„åˆ’æä¾›ç§‘å­¦ä¾æ®
- æ”¯æŒå¤šç›®æ ‡ä¼˜åŒ–å†³ç­–

"""
    
    # ä¿å­˜æŠ¥å‘Š
    report_file = "analysis/charts/correlation/metrics_definition_report.md"
    with open(report_file, 'w', encoding='utf-8') as f:
        f.write(report_content)
    
    print(f"âœ… æŒ‡æ ‡æ‘˜è¦æŠ¥å‘Šå·²ä¿å­˜åˆ°: {report_file}")
    return report_file

def main():
    """ä¸»å‡½æ•°"""
    print("ğŸ“Š åˆ›å»ºåŠ¨æ€æ€§èƒ½æŒ‡æ ‡å®šä¹‰æŒ‡å—")
    print("=" * 50)
    
    # åˆ›å»ºæŒ‡æ ‡å®šä¹‰è¡¨æ ¼
    df_chinese, df_english = create_metrics_definition_guide()
    
    # åˆ›å»ºæ‘˜è¦æŠ¥å‘Š
    report_file = create_metrics_summary_report()
    
    print(f"\nğŸ‰ æŒ‡æ ‡å®šä¹‰æ–‡æ¡£åˆ›å»ºå®Œæˆ!")
    print(f"ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶:")
    print(f"   â€¢ metrics_definition_guide.csv - è¯¦ç»†ä¸­æ–‡å®šä¹‰è¡¨æ ¼")
    print(f"   â€¢ metrics_definition_english.csv - è‹±æ–‡å®šä¹‰è¡¨æ ¼") 
    print(f"   â€¢ metrics_definition_report.md - æŒ‡æ ‡æ‘˜è¦æŠ¥å‘Š")
    print(f"\nğŸ“Š æŒ‡æ ‡ç»Ÿè®¡:")
    print(f"   â€¢ æ€»è®¡: 20ä¸ªåŠ¨æ€æ€§èƒ½æŒ‡æ ‡")
    print(f"   â€¢ åˆ†ç±»: 6å¤§ç±»æŒ‡æ ‡ä½“ç³»")
    print(f"   â€¢ æ•°æ®æº: 2ä¸ªSUMOè¾“å‡ºæ–‡ä»¶")
    
    # æ˜¾ç¤ºåˆ†ç±»ç»Ÿè®¡
    category_counts = df_chinese['åˆ†ç±»'].value_counts()
    print(f"\nğŸ“ˆ å„ç±»æŒ‡æ ‡æ•°é‡:")
    for category, count in category_counts.items():
        print(f"   â€¢ {category}: {count}ä¸ª")

if __name__ == '__main__':
    main()
